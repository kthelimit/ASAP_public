<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layout/basic :: setContent(~{this::content})}">
    <th:block th:fragment="content">

        <div class="col-lg-12">
            <div class="card-style mb-30">
                <h3 class="mb-10">납입지시 요청</h3>
                <div class="search_tab">
                    <div class="table-wrapper table-responsive">
                        <!-- 처리 중인 주문 테이블 -->
                        <h4>처리 중인 주문</h4>
                        <table class="table">
                            <thead>
                            <tr>
                                <th>발주 번호</th>
                                <th>공급사</th>
                                <th>부품 종류</th>
                                <th>자재 이름</th>
                                <th>발주일</th>
                                <th>입고 예정일</th>
                                <th>요청 가능 수량</th>
                                <th>필요 조달 수량</th>
                                <th>요청 수량</th>
                                <th>상태</th>
                            </tr>
                            </thead>
                            <tbody>
                            <!-- 처리 중인 주문 리스트 -->
                            <tr th:each="orderP : ${purchaseOrders}" >
                                <td th:text="${orderP.orderCode}"></td>
                                <td th:text="${orderP.supplierName}"></td>
                                <td th:text="${orderP.materialType}"></td>
                                <td th:text="${orderP.materialName}"></td>
                                <td th:text="${orderP.orderDate}"></td>
                                <td th:text="${orderP.expectedDate}"></td>
                                <td th:text="${orderP.availableStock > 0 ? orderP.availableStock : 0}"></td>
                                <td th:text="${orderP.requiredQuantity}"></td>
                                <td>
                                    <form th:action="@{/order/delivery/request}" method="post">
                                        <input type="hidden" name="orderId" th:value="${orderP.orderId}">
                                        <input type="number" name="requestedQuantity" min="1"
                                               th:attr="max=${orderP.availableStock > 0 ? orderP.availableStock : 0}" required>
                                        <button type="submit">납입 요청</button>
                                    </form>
                                </td>
                                <td th:text="${orderP.status}"></td>
                            </tr>

                            <!-- 리스트가 비어 있을 경우 -->
                            <tr th:if="${#lists.isEmpty(purchaseOrders)}">
                                <td colspan="10" style="text-align: center;">등록된 정보가 없습니다.</td>
                            </tr>
                            </tbody>
                        </table>

                        <!-- 처리 중인 주문 페이지네이션 -->
                        <div class="pagination-wrapper">
                            <ul class="pagination">
                                <li th:if="${purchaseCurrentPage > 1}">
                                    <a th:href="@{/order/delivery(page=${purchaseCurrentPage - 1}, size=${size})}">&laquo;</a>
                                </li>
                                <li th:each="i : ${#numbers.sequence(1, purchaseTotalPages)}">
                                    <a th:classappend="${i == purchaseCurrentPage ? 'active' : ''}"
                                       th:href="@{/order/delivery(page=${i}, size=${size})}"
                                       th:text="${i}"></a>
                                </li>
                                <li th:if="${purchaseCurrentPage < purchaseTotalPages}">
                                    <a th:href="@{/order/delivery(page=${purchaseCurrentPage + 1}, size=${size})}">&raquo;</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <hr/>
                <!-- 출고 요청 테이블 -->
                <h4>출고 요청 목록</h4>
                <div class="table-wrapper table-responsive">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>발주 번호</th>
                            <th>공급사</th>
                            <th>자재 이름</th>
                            <th>요청 수량</th>
                            <th>요청일</th>
                            <th>상태</th>
                        </tr>
                        </thead>
                        <tbody>
                        <!-- 출고 요청 리스트 -->
                        <tr th:each="deliveryRequest : ${deliveryRequests}">
                            <td th:text="${deliveryRequest.orderCode}"></td>
                            <td th:text="${deliveryRequest.supplierName}"></td>
                            <td th:text="${deliveryRequest.materialName}"></td>
                            <td th:text="${deliveryRequest.requestedQuantity}"></td>
                            <td th:text="${deliveryRequest.requestedAt}"></td>
                            <td th:text="${deliveryRequest.status}"></td>
                        </tr>

                        <!-- 리스트가 비어 있을 경우 -->
                        <tr th:if="${#lists.isEmpty(deliveryRequests)}">
                            <td colspan="7" style="text-align: center;">출고 요청이 없습니다.</td>
                        </tr>
                        </tbody>
                    </table>

                    <!-- 출고 요청 목록 페이지네이션 -->
                    <div class="pagination-wrapper">
                        <ul class="pagination">
                            <li th:if="${deliveryCurrentPage > 1}">
                                <a th:href="@{/order/delivery(deliveryPage=${deliveryCurrentPage - 1}, deliverySize=${size})}">&laquo;</a>
                            </li>
                            <li th:each="i : ${#numbers.sequence(1, deliveryTotalPages)}">
                                <a th:classappend="${i == deliveryCurrentPage ? 'active' : ''}"
                                   th:href="@{/order/delivery(deliveryPage=${i}, deliverySize=${size})}"
                                   th:text="${i}"></a>
                            </li>
                            <li th:if="${deliveryCurrentPage < deliveryTotalPages}">
                                <a th:href="@{/order/delivery(deliveryPage=${deliveryCurrentPage + 1}, deliverySize=${size})}">&raquo;</a>
                            </li>
                        </ul>
                    </div>
                </div>

                <hr/>


                <!-- 처리 완료된 주문 테이블 -->
                <h4>처리 완료된 주문</h4>
                <div class="table-wrapper table-responsive">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>발주 번호</th>
                            <th>공급사</th>
                            <th>부품 종류</th>
                            <th>자재 이름</th>
                            <th>납입 총 수량</th>
                            <th>발주일</th>
                            <th>입고 예정일</th>
                            <th>최종 상태</th>
                        </tr>
                        </thead>
                        <tbody>
                        <!-- 처리 완료된 주문 리스트 -->
                        <tr th:each="completedOrder : ${completedOrders}">
                            <td th:text="${completedOrder.orderCode}"></td>
                            <td th:text="${completedOrder.supplierName}"></td>
                            <td th:text="${completedOrder.materialType}"></td>
                            <td th:text="${completedOrder.materialName}"></td>
                            <td th:text="${completedOrder.orderQuantity}"></td>
                            <td th:text="${completedOrder.orderDate}"></td>
                            <td th:text="${completedOrder.expectedDate}"></td>
                            <td th:text="${completedOrder.status}"></td>
                        </tr>

                        <!-- 리스트가 비어 있을 경우 -->
                        <tr th:if="${#lists.isEmpty(completedOrders)}">
                            <td colspan="8" style="text-align: center;">처리 완료된 주문이 없습니다.</td>
                        </tr>
                        </tbody>
                    </table>

                    <!-- 처리 완료된 주문 페이지네이션 -->
                    <div class="pagination-wrapper">
                        <ul class="pagination">
                            <li th:if="${completedCurrentPage > 1}">
                                <a th:href="@{/order/delivery(completedPage=${completedCurrentPage - 1}, completedSize=${size})}">&laquo;</a>
                            </li>
                            <li th:each="i : ${#numbers.sequence(1, completedTotalPages)}">
                                <a th:classappend="${i == completedCurrentPage ? 'active' : ''}"
                                   th:href="@{/order/delivery(completedPage=${i}, completedSize=${size})}"
                                   th:text="${i}"></a>
                            </li>
                            <li th:if="${completedCurrentPage < completedTotalPages}">
                                <a th:href="@{/order/delivery(completedPage=${completedCurrentPage + 1}, completedSize=${size})}">&raquo;</a>
                            </li>
                        </ul>
                    </div>
                </div>


            </div>
        </div>
    </th:block>
</th:block>
</html>
