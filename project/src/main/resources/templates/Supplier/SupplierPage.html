<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{layout/basic :: setContent(~{this::content})}">
    <th:block th:fragment="content">
        <div class="container-fluid">
            <!-- ========== title-wrapper start ========== -->
            <div class="title-wrapper pt-30">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <div class="title">
                            <h2>협력사 페이지</h2>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="breadcrumb-wrapper">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item">
                                        <a href="#0">업체관리</a>
                                    </li>
                                    <li class="breadcrumb-item">
                                        <a href="#0">협력사 페이지</a>
                                    </li>
                                </ol>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ========== title-wrapper end ========== -->

            <div class="tables-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <!-- 협력사 기본 정보 -->
                            <h3 class="mb-10">협력사 기본 정보</h3>
                            <div class="supplier-info">
                                <p><strong>업체명:</strong> [[${supplierDTO.supplierName}]]</p>
                                <p><strong>사업자 번호:</strong> [[${supplierDTO.businessRegistrationNumber}]]</p>
                                <p><strong>연락처:</strong> [[${supplierDTO.contactInfo}]]</p>
                                <p><strong>주소:</strong> [[${supplierDTO.address}]]</p>
                                <p><strong>업태:</strong> [[${supplierDTO.businessType}]]</p>
                                <p><strong>종목:</strong> [[${supplierDTO.businessItem}]]</p>
                                <div class="row" style="justify-content: flex-end">
                                    <div class="col-lg-1" style="min-width: 144px">
                                        <!-- 수정 버튼 -->
                                        <a th:href="@{/suppliers/modifyform/{id}(id=${supplier.supplierId})}"
                                           class="btn-approve main-btn btn-hover primary-btn">
                                            수정
                                        </a>
                                    </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- 거래 내역 요약 -->
            <div class="tables-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <h3 class="mb-10">거래 내역 요약</h3>
                            <p><strong>총 거래 금액:</strong> ₩[[${#numbers.formatInteger(totalAmount, 3, 'COMMA')}]]</p>


                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="card-style mb-30">
                                        <div class="title d-flex flex-wrap align-items-center justify-content-between">
                                            <div class="left">
                                                <h6 class="text-medium mb-2">재고</h6>
                                            </div>
                                            <div class="right">
                                                <div class="select-style-1 mb-2">
                                                    <div class="select-position select-sm">
                                                        <select class="light-bg">
                                                            <option value="" selected>이번 달</option>
                                                            <option value="">저번 달</option>
                                                            <option value="">지난 3개월</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <!-- end select -->
                                            </div>
                                        </div>
                                        <!-- End Title -->
                                        <div class="chart">
                                            <div id="legend3">
                                                <!--                                                <ul class="legend3 d-flex flex-wrap align-items-center mb-30">-->
                                                <!--                                                    <li>-->
                                                <!--                                                        <div class="d-flex">-->
                                                <!--                                                            <span class="bg-color primary-bg"> </span>-->
                                                <!--                                                            <div class="text">-->
                                                <!--                                                                <p class="text-sm text-success">-->
                                                <!--                                                                    <span class="text-dark">수량</span> +25.55%-->
                                                <!--                                                                    <i class="lni lni-arrow-up"></i>-->
                                                <!--                                                                </p>-->
                                                <!--                                                            </div>-->
                                                <!--                                                        </div>-->
                                                <!--                                                    </li>-->
                                                <!--                                                    <li>-->
                                                <!--                                                        <div class="d-flex">-->
                                                <!--                                                            <span class="bg-color purple-bg"></span>-->
                                                <!--                                                            <div class="text">-->
                                                <!--                                                                <p class="text-sm text-success">-->
                                                <!--                                                                    <span class="text-dark">금액</span> +45.55%-->
                                                <!--                                                                    <i class="lni lni-arrow-up"></i>-->
                                                <!--                                                                </p>-->
                                                <!--                                                            </div>-->
                                                <!--                                                        </div>-->
                                                <!--                                                    </li>-->
                                                <!--                                                    <li>-->
                                                <!--                                                        <div class="d-flex">-->
                                                <!--                                                            <span class="bg-color orange-bg"></span>-->
                                                <!--                                                            <div class="text">-->
                                                <!--                                                                <p class="text-sm text-danger">-->
                                                <!--                                                                    <span class="text-dark">다른 거 하나</span> -4.2%-->
                                                <!--                                                                    <i class="lni lni-arrow-down"></i>-->
                                                <!--                                                                </p>-->
                                                <!--                                                            </div>-->
                                                <!--                                                        </div>-->
                                                <!--                                                    </li>-->
                                                <!--                                                </ul>-->
                                            </div>
                                            <canvas id="Chart4"
                                                    style="width: 100%; height: 450px; margin-left: -35px;"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- 연별 거래 요약 -->
                            <h4 class="mt-20">연별 거래 금액</h4>
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="text-center" style="width: 50%"><h6>연도</h6></th>
                                    <th class="text-center" style="width: 50%"><h6>거래 금액</h6></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="entry : ${yearlySummary}">
                                    <td class="text-center">[[${entry.key}]]</td>
                                    <td class="text-center">₩[[${#numbers.formatInteger(entry.value, 3, 'COMMA')}]]</td>
                                </tr>
                                <tr th:if="${#lists.isEmpty(yearlySummary)}">
                                    <td class="text-center" colspan="2">데이터가 없습니다.</td>
                                </tr>
                                </tbody>
                            </table>

                            <!-- 월별 거래 요약 -->
                            <h4 class="mt-20">월별 거래 금액</h4>
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="text-center" style="width: 50%"><h6>월</h6></th>
                                    <th class="text-center" style="width: 50%"><h6>거래 금액</h6></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="entry : ${monthlySummary}">
                                    <td class="text-center">[[${entry.key}]]</td>
                                    <td class="text-center">₩[[${#numbers.formatInteger(entry.value, 3, 'COMMA')}]]</td>
                                </tr>
                                <tr th:if="${#lists.isEmpty(monthlySummary)}">
                                    <td class="text-center" colspan="2">데이터가 없습니다.</td>
                                </tr>
                                </tbody>
                            </table>

                            <!-- 주별 거래 요약 -->
                            <h4 class="mt-20">주별 거래 금액</h4>
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="text-center" style="width: 50%"><h6>주</h6></th>
                                    <th class="text-center" style="width: 50%"><h6>거래 금액</h6></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="entry : ${weeklySummary}" class="data-row">
                                    <td class="text-center">[[${entry.key}]]</td>

                                    <td class="text-center price">₩[[${#numbers.formatInteger(entry.value.totalPrice, 3, 'COMMA')}]]
                                    </td>
                                    <td class="quantity">
                                        <input type="hidden" th:value="${entry.value.quantity}"/>
                                    </td>
                                </tr>
                                <tr th:if="${#lists.isEmpty(weeklySummary)}">
                                    <td class="text-center" colspan="2">데이터가 없습니다.</td>
                                </tr>
                                </tbody>
                            </table>


                        </div>
                    </div>
                </div>
            </div>

            <!-- 취급 자재 품목 -->
            <div class="tables-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <span class="anchor" id="stock"></span>
                            <h3 class="mb-10">취급 자재 품목</h3>
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="text-center"><h6>자재 이름</h6></th>
                                    <th class="text-center"><h6>단가</h6></th>
                                    <th class="text-center"><h6>최소 공급 수량</h6></th>
                                    <th class="text-center"><h6>현재 재고 수량</h6></th>
                                    <th class="text-center"><h6>가용 재고 수량</h6></th>
                                    <th class="text-center"><h6>재고 수량 수정</h6></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="stock : ${supplierStocks}">
                                    <td class="min-width">[[${stock.materialName}]]</td>
                                    <td class="min-width text-align-right">[[${#numbers.formatInteger(stock.unitPrice,
                                        3, 'COMMA')}]]
                                    </td>
                                    <td class="min-width text-center">[[${stock.quantity}]]</td>
                                    <td class="min-width text-center">[[${stock.stock}]]</td>
                                    <td class="min-width text-center">
                                        <span class="text-danger" th:if="${stock.availableStock<0}">[[${stock.availableStock}]]</span>
                                        <span th:if="${stock.availableStock>=0}">[[${stock.availableStock}]]</span>
                                    </td>
                                    <td class="min-width">
                                        <form method="POST" th:action="@{/suppliers/stockUpdate}">
                                            <input name="supplierStockId" th:value="${stock.supplierStockId}"
                                                   type="hidden">
                                            <div class="row" style="justify-content: flex-end; height: 60px">
                                                <div class="input-style-1 col-lg-4" style="margin-bottom: 0">
                                                    <input name="stock" style="width: 100px"
                                                           th:value="${stock.stock}" type="number">
                                                </div>
                                                <div class="col-lg-3" style="min-width: 180px">
                                                    <button class="main-btn primary-btn btn-hover" type="submit">수량 수정
                                                    </button>
                                                </div>
                                            </div>
                                        </form>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 발주 요청 관리 -->
            <div class="tables-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <span class="anchor" id="order"></span>
                            <h3 class="table-title mb-10">발주 관리</h3>
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="text-center"><h6>요청 ID</h6></th>
                                    <th class="text-center"><h6>부품 유형</h6></th>
                                    <th class="text-center"><h6>자재 이름</h6></th>
                                    <th class="text-center"><h6>요청 수량</h6></th>
                                    <th class="text-center"><h6>남은 수량</h6></th>
                                    <th class="text-center"><h6>합계 금액</h6></th>
                                    <th class="text-center"><h6>요청 날짜</h6></th>
                                    <th class="text-center"><h6>진척 검수</h6></th>
                                    <th class="text-center"><h6>상태</h6></th>
                                    <th class="text-center"><h6>Action</h6></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="orderRequest : ${orderRequests}">
                                    <td class="text-center min-width" th:text="${orderRequest.orderCode}"></td>
                                    <td class="text-center min-width" th:text="${orderRequest.materialType}"></td>
                                    <td class="min-width" th:text="${orderRequest.materialName}"></td>
                                    <td class="text-align-right min-width" th:text="${orderRequest.orderQuantity}"></td>
                                    <td class="text-align-right min-width"
                                        th:text="${orderRequest.remainedQuantity}"></td>
                                    <td class="text-align-right min-width" th:text="${#numbers.formatInteger(orderRequest.totalPrice, 3,
                                    'COMMA')}"></td>
                                    <td class="text-center min-width" th:text="${orderRequest.orderDate}"></td>
                                    <td class="text-center min-width">
                                        [[${orderRequest.finishedInspection}]]/[[${orderRequest.totalInspection}]]
                                    </td>
                                    <td class="text-center min-width">
                                        <span class="status-btn success-btn" th:if="${orderRequest.status=='ON_HOLD'}">대기 중</span>
                                        <span class="status-btn close-btn"
                                              th:if="${orderRequest.status=='REJECT'}">거절 완료</span>
                                        <span class="status-btn active-btn"
                                              th:if="${orderRequest.status=='APPROVAL'}">승인 완료</span>
                                        <span class="status-btn active-btn"
                                              th:if="${orderRequest.status=='DELIVERED'}">배송 완료</span>
                                        <span class="status-btn info-btn"
                                              th:if="${orderRequest.status=='FINISHED'}">종료</span>
                                    </td>
                                    <td class="text-center min-width">
                                        <div th:if="${orderRequest.status == 'ON_HOLD'}">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <form method="post" th:action="@{/suppliers/orders/approve}">
                                                        <input name="orderId" th:value="${orderRequest.orderId}"
                                                               type="hidden">
                                                        <button class="main-btn primary-btn btn-hover btn-approve"
                                                                type="submit">수락
                                                        </button>
                                                    </form>
                                                </div>
                                                <div class="col-lg-6">
                                                    <form method="post" th:action="@{/suppliers/orders/reject}">
                                                        <input name="orderId" th:value="${orderRequest.orderId}"
                                                               type="hidden">
                                                        <button class="main-btn primary-btn btn-hover btn-reject"
                                                                type="submit">거절
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        <span th:if="${orderRequest.status != 'ON_HOLD'}">-</span>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <div class="pagination-wrapper">
                                <ul class="pagination">
                                    <!-- 이전 페이지 버튼 -->
                                    <li th:if="${currentOrderPage > 1}">
                                        <a th:href="@{/suppliers/page(page=${currentOrderPage - 1}, size=${size})}">&laquo;</a>
                                    </li>

                                    <!-- 페이지 번호 버튼 -->
                                    <li th:each="i : ${#numbers.sequence(1, totalOrderPages)}">
                                        <a th:classappend="${i == currentOrderPage ? 'active' : ''}"
                                           th:if="${(currentOrderPage/10)*10 <= i and i<=(currentOrderPage/10 +1)*10  and i!=0}"
                                           th:href="@{/suppliers/page(page=${i}, size=${size})}"
                                           th:text="${i}"></a>
                                    </li>

                                    <!-- 다음 페이지 버튼 -->
                                    <li th:if="${currentOrderPage < totalOrderPages}">
                                        <a th:href="@{/suppliers/page(page=${currentOrderPage + 1}, size=${size})}">&raquo;</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 진척 검수 테이블 -->
            <div class="tables-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <div id="inspectionTable">
                                <span class="anchor" id="inspection"></span>
                                <h3 class="table-title mb-10">진척 검수</h3>
                                <p class="text-sm mb-20">
                                    아직 완료되지 않은 진척 검수와 검수 요청 날짜가 3일 전인 완료 건수만 뜹니다.
                                </p>
                                <table class="table">
                                    <tr>
                                        <th class="text-center"><h6>발주 번호</h6></th>
                                        <th class="text-center"><h6>진척 검수 차수</h6></th>
                                        <th class="text-center"><h6>자재 이름</h6></th>
                                        <th class="text-center"><h6>수량</h6></th>
                                        <th class="text-center"><h6>검수 요청 날짜</h6></th>
                                        <th class="text-center"><h6>검수 상태</h6></th>
                                        <th class="text-center"><h6>검수</h6></th>
                                    </tr>
                                    <tr th:each="inspection : ${inspectionDTOS}">
                                        <td class="text-center min-width" th:text="${inspection.orderCode}"></td>
                                        <td class="text-center min-width" th:text="${inspection.inspectionRound}"></td>
                                        <td class="min-width" th:text="${inspection.materialName}"></td>
                                        <td class="text-center min-width">
                                            <th:block th:if="${inspection.inspectionQuantity==null}">
                                                - / [[${inspection.remainingQuantity}]]
                                            </th:block>
                                            <th:block th:if="${inspection.inspectionQuantity!=null}">
                                                [[${inspection.inspectionQuantity}]] /
                                                [[${inspection.remainingQuantity}]]
                                            </th:block>
                                        </td>
                                        <td class="text-center min-width" th:text="${inspection.inspectionDate}"></td>
                                        <td class="text-center min-width">
                                            <span class="status-btn success-btn"
                                                  th:if="${inspection.status=='ON_HOLD'}">대기 중</span>
                                            <span class="status-btn close-btn"
                                                  th:if="${inspection.status=='FINISHED'}">검수 완료</span>
                                        </td>
                                        <td class="text-center min-width" style="width: 20%">
                                            <th:block th:if="${inspection.status=='ON_HOLD'}">
                                                <form method="post" th:action="@{/order/inspectionUpdate}">
                                                    <input name="inspectionId" th:value="${inspection.inspectionId}"
                                                           type="hidden">
                                                    <div class="row">
                                                        <div class="col-lg-8 input-style-1  mb-0">
                                                            <input name="inspectionQuantity" placeholder="검수 수량"
                                                                   type="number">
                                                        </div>
                                                        <div class="col-lg-4 input-style-1  mb-0">
                                                            <button class="main-btn primary-btn btn-hover"
                                                                    style="padding: 16px 24px">완료
                                                            </button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </th:block>
                                            <th:block th:if="${inspection.status=='FINISHED'}">
                                                -
                                            </th:block>
                                        </td>

                                    </tr>
                                </table>
                                <div class="pagination-wrapper">
                                    <ul class="pagination">
                                        <!-- 이전 페이지 버튼 -->
                                        <li th:if="${inspectionCurrentPage > 1}">
                                            <a th:href="@{/suppliers/page(page=${inspectionCurrentPage - 1}, size=${size})}">&laquo;</a>
                                        </li>

                                        <!-- 페이지 번호 버튼 -->
                                        <li th:each="i : ${#numbers.sequence(1, inspectionTotalPages)}">
                                            <a th:classappend="${i == inspectionCurrentPage ? 'active' : ''}"
                                               th:if="${(inspectionCurrentPage/10)*10 <= i and i<=(inspectionCurrentPage/10 +1)*10  and i!=0}"
                                               th:href="@{/suppliers/page(page=${i}, size=${size})}"
                                               th:text="${i}"></a>
                                        </li>

                                        <!-- 다음 페이지 버튼 -->
                                        <li th:if="${inspectionCurrentPage < inspectionTotalPages}">
                                            <a th:href="@{/suppliers/page(page=${inspectionCurrentPage + 1}, size=${size})}">&raquo;</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tables-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <div id="ExportTable">
                                <span class="anchor" id="delivery"></span>
                                <h3 class="table-title mb-10">납품 지시 요청</h3>
                                <p class="text-sm mb-20">
                                    현재 처리되지 않은 납품지시가 위쪽에 뜹니다.
                                </p>
                                <form method="post" th:action="@{/suppliers/importregisterbatch}"
                                      th:object="${ImportDTO}">
                                    <input name="supplierName" th:value="${supplierName}" type="hidden">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th class="text-center">
                                                <input id="selectAll" onclick="toggleAllCheckboxes(this)"
                                                       type="checkbox"> <!-- 전체 선택 -->
                                            </th>
                                            <th class="text-center"><h6>납품 지시 번호</h6></th>
                                            <th class="text-center"><h6>발주 번호</h6></th>
                                            <th class="text-center"><h6>자재 이름</h6></th>
                                            <th class="text-center"><h6>요청 수량</h6></th>
                                            <th class="text-center"><h6>배달 요청일</h6></th>
                                            <th class="text-center"><h6>상태</h6></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:each="request : ${deliveryRequests}">
                                            <td class="text-center">
                                                <input name="selectedRequests"
                                                       th:if="${request.status == 'IN_PROGRESS'}"
                                                       th:value="${request.id}" type="checkbox">
                                            </td>
                                            <td class="text-center" th:text="${request.deliveryCode}"></td>
                                            <td class="text-center" th:text="${request.orderCode}"></td>
                                            <input name="orderCode" th:value="${request.orderCode}" type="hidden">
                                            <td class="text-center" th:text="${request.materialName}"></td>
                                            <input name="materialName" th:value="${request.materialName}" type="hidden">
                                            <td class="text-center" th:text="${request.requestedQuantity}"></td>
                                            <input name="quantity" th:value="${request.requestedQuantity}"
                                                   type="hidden">
                                            <td class="text-center"
                                                th:text="${#temporals.format(request.requestedDate)}"></td>
                                            <input name="expectedDate" th:value="${request.requestedDate}"
                                                   type="hidden">
                                            <td class="text-center">
                                                   <span class="status-btn success-btn"
                                                         th:if="${request.status == 'FINISHED'}">납품 완료</span>
                                                <span class="status-btn success-btn"
                                                      th:if="${request.status == 'DELIVERED'}">배달중</span>
                                                <span class="status-btn success-btn"
                                                      th:if="${request.status == 'ARRIVED'}">도착</span>
                                                <span class="status-btn close-btn"
                                                      th:if="${request.status == 'IN_PROGRESS'}">요청 중</span>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                    <!-- 일괄 출고 버튼 -->
                                    <div class="text-end mt-3">
                                        <button class="btn btn-primary" type="submit">선택 출고</button>
                                    </div>
                                </form>
                                <div class="pagination-wrapper">
                                    <ul class="pagination">
                                        <!-- 이전 페이지 버튼 -->
                                        <li th:if="${deliveryCurrentPage > 1}">
                                            <a th:href="@{/suppliers/page(deliveryPage=${deliveryCurrentPage - 1}, deliverySize=${deliverySize})}">&laquo;</a>
                                        </li>

                                        <!-- 페이지 번호 버튼 -->
                                        <li th:each="i : ${#numbers.sequence(1, deliveryTotalPages)}">
                                            <a th:classappend="${i == deliveryCurrentPage ? 'active' : ''}"
                                               th:if="${(deliveryCurrentPage/10)*10 <= i and i<=(deliveryCurrentPage/10 +1)*10  and i!=0}"
                                               th:href="@{/suppliers/page(deliveryPage=${i}, deliverySize=${deliverySize})}"
                                               th:text="${i}"></a>
                                        </li>

                                        <!-- 다음 페이지 버튼 -->
                                        <li th:if="${deliveryCurrentPage < deliveryTotalPages}">
                                            <a th:href="@{/suppliers/page(deliveryPage=${deliveryCurrentPage + 1}, deliverySize=${deliverySize})}">&raquo;</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 반품 테이블 -->
            <div class="tables-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <div id="returnTable">
                                <span class="anchor" id="returns"></span>
                                <h3 class="table-title">불량품 재배송</h3>
                                <p class="text-sm mb-20">
                                    상대업체에 도착했으나 불량으로 검수된 것들을 다시 보냅니다. 아직 완료되지 않은 건수만 뜹니다.
                                </p>
                                <table class="table">
                                    <tr>
                                        <th class="text-center"><h6>반품 번호</h6></th>
                                        <th class="text-center"><h6>발주 번호</h6></th>
                                        <th class="text-center"><h6>자재 이름</h6></th>
                                        <th class="text-center"><h6>불량품 수</h6></th>
                                        <th class="text-center"><h6>요청일</h6></th>
                                        <th class="text-center"><h6>Action</h6></th>
                                    </tr>
                                    <tr th:each="return : ${returns}">
                                        <td class="min-width text-center"><p th:text="${return.returnCode}"></td>
                                        <td class="min-width text-center"><p th:text="${return.importCode}"></td>
                                        <td class="min-width text-center"><p th:text="${return.materialName}"></td>
                                        <td class="min-width text-center"><p th:text="${return.quantity}"></td>
                                        <td class="min-width text-center"><p
                                                th:text="${#temporals.format(return.createdDate, 'yyyy-MM-dd')}"></td>
                                        <td class="min-width text-center">
                                            <form method="post" th:action="@{/suppliers/returnUpdate}">
                                                <input name="returnId" th:value="${return.returnId}" type="hidden">
                                                <button class="main-btn primary-btn btn-hover">재출고</button>
                                            </form>
                                        </td>
                                    </tr>
                                </table>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 거래 명세서 -->
            <div class="tables-wrapper">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card-style mb-30">
                            <h3 class="table-title">거래 명세서</h3>
                            <table class="table">
                                <thead>
                                <tr>
                                    <th class="text-center"><h6>자재 이름</h6></th>
                                    <th class="text-center"><h6>단가</h6></th>
                                    <th class="text-center"><h6>수량</h6></th>
                                    <th class="text-center"><h6>총 가격</h6></th>
                                    <th class="text-center"><h6>거래 날짜</h6></th>
                                    <th class="text-center"><h6>상세 보기</h6></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="invoice : ${invoices}">
                                    <td class="text-center" th:text="${invoice.materialName}"></td>
                                    <td class="text-center"
                                        th:text="${#numbers.formatInteger(invoice.unitPrice, 3,  'COMMA')}"></td>
                                    <td class="text-center" th:text="${invoice.quantity}"></td>
                                    <td class="text-center"
                                        th:text="${#numbers.formatInteger(invoice.totalPrice, 3,'COMMA')}"></td>
                                    <td class="text-center"
                                        th:text="${#temporals.format(invoice.createdDate, 'yyyy-MM-dd')}"></td>
                                    <td class="text-center">
                                        <a class="main-btn primary-btn btn-hover"
                                           href="javascript:void(0);"
                                           th:onclick="window.open('/invoice/detail/[[${invoice.invoiceId}]]', '거래 명세서', 'width=1200, height=600, resizable=yes')">상세보기</a>

                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <!-- 거래 명세서 페이징 -->
                            <div class="pagination-wrapper" th:if="${invoiceTotalPages > 0}">
                                <ul class="pagination">
                                    <!-- 이전 페이지 버튼 -->
                                    <li th:if="${invoiceCurrentPage > 1}">
                                        <a th:href="@{/suppliers/page(invoicePage=${invoiceCurrentPage - 1}, invoiceSize=${invoiceSize})}">&laquo;</a>
                                    </li>

                                    <!-- 페이지 번호 버튼 -->
                                    <li th:each="i : ${#numbers.sequence(1, invoiceTotalPages)}">
                                        <a th:classappend="${i == invoiceCurrentPage ? 'active' : ''}"
                                           th:if="${(invoiceCurrentPage/10)*10 <= i and i<=(invoiceCurrentPage/10 +1)*10  and i!=0}"
                                           th:href="@{/suppliers/page(invoicePage=${i}, invoiceSize=${invoiceSize})}"
                                           th:text="${i}"></a>
                                    </li>

                                    <!-- 다음 페이지 버튼 -->
                                    <li th:if="${invoiceCurrentPage < invoiceTotalPages}">
                                        <a th:href="@{/suppliers/page(invoicePage=${invoiceCurrentPage + 1}, invoiceSize=${invoiceSize})}">&raquo;</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="/assets/js/Chart.min.js"></script>

        <script>
            // 곡선 그래프 시작
            //
            // const ctx3 = document.getElementById("Chart3").getContext("2d");
            //
            // // 데이터 수집 및 주차별 데이터 매핑
            // let rows = document.querySelectorAll('.data-row');
            // let weekPrices = [0, 0, 0, 0, 0]; // 1~5주차 초기화
            // let weekQuantities = [0, 0, 0, 0, 0]; // 1~5주차 초기화
            //
            // rows.forEach(row => {
            //     let priceCell = row.querySelector('.price');
            //     let quantityInput = row.querySelector('.quantity input');
            //     let weekCell = row.querySelector('td:first-child'); // 첫 번째 열은 주차
            //
            //     if (priceCell && quantityInput && weekCell) {
            //         // 주차 숫자 추출 (예: "2024년 12월 1주차" -> 1)
            //         let weekMatch = weekCell.innerText.match(/(\d+)주차/);
            //         if (weekMatch) {
            //             let week = parseInt(weekMatch[1]); // 매칭된 주차 숫자 추출
            //             if (week >= 1 && week <= 5) { // 1~5주차만 처리
            //                 let price = parseInt(priceCell.innerText.replace(/[₩,]/g, ''));
            //                 let quantity = parseInt(quantityInput.value);
            //                 weekPrices[week - 1] = price; // 주차에 맞는 인덱스에 값 저장
            //                 weekQuantities[week - 1] = quantity; // 주차에 맞는 인덱스에 값 저장
            //             }
            //         }
            //     }
            // });
            //
            // // Chart.js 생성
            // const chart3 = new Chart(ctx3, {
            //     type: "line",
            //     data: {
            //         labels: [
            //             "1주차",
            //             "2주차",
            //             "3주차",
            //             "4주차",
            //             "5주차",
            //         ],
            //         datasets: [
            //             {
            //                 label: "거래 금액 (₩)",
            //                 backgroundColor: "transparent",
            //                 borderColor: "#365CF5",
            //                 data: weekPrices,
            //                 yAxisID: "y2",
            //                 pointBackgroundColor: "#365CF5",
            //                 pointHoverBackgroundColor: "#365CF5",
            //                 pointBorderColor: "transparent",
            //                 pointHoverBorderColor: "#365CF5",
            //                 pointHoverBorderWidth: 3,
            //                 pointBorderWidth: 5,
            //                 pointRadius: 5,
            //                 pointHoverRadius: 8,
            //                 fill: false,
            //                 tension: 0.4,
            //                 pointStyle: 'circle', // 범례 도형을 원으로 설정
            //             },
            //             {
            //                 label: "거래 수량",
            //                 backgroundColor: "transparent",
            //                 borderColor: "#9b51e0",
            //                 data: weekQuantities,
            //                 yAxisID: "y",
            //                 pointBackgroundColor: "#9b51e0",
            //                 pointHoverBackgroundColor: "#9b51e0",
            //                 pointBorderColor: "transparent",
            //                 pointHoverBorderColor: "#9b51e0",
            //                 pointHoverBorderWidth: 3,
            //                 pointBorderWidth: 5,
            //                 pointRadius: 5,
            //                 pointHoverRadius: 8,
            //                 fill: false,
            //                 tension: 0.4,
            //                 pointStyle: 'circle', // 범례 도형을 원으로 설정
            //             },
            //         ],
            //     },
            //     options: {
            //         plugins: {
            //             tooltip: {
            //                 intersect: false,
            //                 backgroundColor: "#fbfbfb",
            //                 titleColor: "#8F92A1",
            //                 bodyColor: "#272727",
            //                 titleFont: {
            //                     size: 16,
            //                     family: "Plus Jakarta Sans",
            //                     weight: "400",
            //                 },
            //                 bodyFont: {
            //                     family: "Plus Jakarta Sans",
            //                     size: 16,
            //                 },
            //                 multiKeyBackground: "transparent",
            //                 displayColors: false,
            //                 padding: {
            //                     x: 30,
            //                     y: 15,
            //                 },
            //                 borderColor: "rgba(143, 146, 161, .1)",
            //                 borderWidth: 1,
            //                 enabled: true,
            //             },
            //             legend: {
            //                 display: true,
            //                 labels: {
            //                     usePointStyle: true, // 범례에서 도형을 데이터셋의 pointStyle로 변경
            //                     padding: 50, // 범례 항목 간 간격 설정
            //                 },
            //             },
            //         },
            //         responsive: true,
            //         scales: {
            //             y: {
            //                 position: 'left',
            //                 grid: {
            //                     display: true,
            //                     drawBorder: true,
            //                 },
            //                 ticks: {
            //                     stepSize: 100,
            //                     callback: function (value) {
            //                         if (value >= 1000) {
            //                             return value.toLocaleString() + "개";
            //                         }
            //                         return value + "개";
            //                     },
            //                 },
            //                 title: {
            //                     display: true
            //                 },
            //             },
            //             y2: {
            //                 position: 'right',
            //                 grid: {
            //                     display: false,
            //                 },
            //                 ticks: {
            //                     stepSize: 50000000,
            //                     callback: function (value) {
            //                         if (value === 0) {
            //                             return "₩0원";
            //                         } else if (value >= 100000000) {
            //                             let result = (value / 100000000).toFixed(1);
            //                             return "₩" + (result.endsWith(".0") ? parseInt(result) : result) + "억원";
            //                         } else {
            //                             return "₩" + (value / 10000000).toFixed(0) + "천만원";
            //                         }
            //                     },
            //                 },
            //                 title: {
            //                     display: true
            //                 },
            //             },
            //             x: {
            //                 grid: {
            //                     drawBorder: false,
            //                     color: "rgba(143, 146, 161, .1)",
            //                     drawTicks: false,
            //                     zeroLineColor: "rgba(143, 146, 161, .1)",
            //                 },
            //                 ticks: {
            //                     padding: 20,
            //                 },
            //             },
            //         },
            //     },
            // });
            // 곡선 그래프 끝

            //========== 막대 그래프 시작
            const ctx4 = document.getElementById("Chart4").getContext("2d");

            // 데이터 수집 및 주차별 데이터 매핑
            let rows = document.querySelectorAll('.data-row');
            let weekPrices = [0, 0, 0, 0, 0];  // 1~5주차 초기화
            let weekQuantities = [0, 0, 0, 0, 0];  // 1~5주차 초기화

            rows.forEach(row => {
                let priceCell = row.querySelector('.price');
                let quantityInput = row.querySelector('.quantity input');
                let weekCell = row.querySelector('td:first-child'); // 첫 번째 열은 주차

                if (priceCell && quantityInput && weekCell) {
                    // 주차 숫자 추출 (예: "2024년 12월 1주차" -> 1)
                    let weekMatch = weekCell.innerText.match(/(\d+)주차/);
                    if (weekMatch) {
                        let week = parseInt(weekMatch[1]); // 매칭된 주차 숫자 추출
                        if (week >= 1 && week <= 5) { // 1~5주차만 처리
                            let price = parseInt(priceCell.innerText.replace(/[₩,]/g, ''));
                            let quantity = parseInt(quantityInput.value);
                            weekPrices[week - 1] = price; // 주차에 맞는 인덱스에 값 저장
                            weekQuantities[week - 1] = quantity; // 주차에 맞는 인덱스에 값 저장
                        }
                    }
                }
            });

            // Chart.js 생성
            const chart4 = new Chart(ctx4, {
                type: "bar",
                data: {
                    labels: ["1주차", "2주차", "3주차", "4주차", "5주차"], // 주차별 라벨 설정
                    datasets: [
                        {
                            label: "거래 수량", // 첫 번째 데이터셋: 거래 수량
                            backgroundColor: "#365CF5", // 거래 수량 바 색상
                            borderColor: "transparent", // 바의 경계 색상
                            borderWidth: 5, // 막대 간 패딩
                            barThickness: 30, // 각 막대의 기본 굵기
                            maxBarThickness: 30, // 막대의 최대 굵기
                            data: weekQuantities, // 거래 수량 데이터
                            yAxisID: "y", // 왼쪽 축에 맞는 데이터셋
                            pointStyle: 'circle',
                        },
                        {
                            label: "거래 금액 (₩)", // 두 번째 데이터셋: 거래 금액
                            backgroundColor: "#9cd2ff", // 거래 금액 바 색상
                            borderColor: "transparent", // 바의 경계 색상
                            borderWidth: 5,
                            barThickness: 30, // 각 막대의 기본 굵기
                            maxBarThickness: 30, // 막대의 최대 굵기
                            data: weekPrices, // 거래 금액 데이터
                            yAxisID: "y2", // 오른쪽 축에 맞는 데이터셋
                            pointStyle: 'circle',
                        },
                    ],
                },
                options: {
                    plugins: {
                        tooltip: {
                            backgroundColor: "#F3F6F8",
                            titleColor: "#8F92A1",
                            titleFontSize: 12,
                            bodyColor: "#171717",
                            bodyFont: {
                                weight: "bold",
                                size: 16,
                            },
                            multiKeyBackground: "transparent",
                            displayColors: false,
                            padding: {
                                x: 30,
                                y: 10,
                            },
                            bodyAlign: "center",
                            titleAlign: "center",
                            enabled: true,
                        },
                        legend: {
                            display: true, // 범례 활성화
                            labels: {
                                boxWidth: 15, // 네모(박스)의 너비 조정
                                boxHeight: 15,
                                usePointStyle: true, // 범례에서 도형을 데이터셋의 pointStyle로 변경
                                padding: 50, // 범례 항목 간 간격 설정
                            },
                        },
                    },
                    layout: {
                        padding: {
                            top: 0,
                        },
                    },
                    responsive: true,
                    title: {
                        display: false,
                    },
                    scales: {
                        y: {
                            position: 'left', // 왼쪽 축
                            grid: {
                                display: true,
                                drawBorder: true,
                            },
                            ticks: {
                                stepSize: 100, // 거래 수량 단위 설정
                                callback: function(value) {
                                    if (value >= 1000) {
                                        return value.toLocaleString() + "개"; // 천 단위로 구분
                                    }
                                    return value + "개"; // 기본적으로 개수로 표시
                                },
                            },
                            title: {
                                display: true,
                            },
                        },
                        y2: {
                            position: 'right', // 오른쪽 축
                            grid: {
                                display: false,
                            },
                            ticks: {
                                stepSize: 50000000, // 거래 금액 단위 설정
                                callback: function(value) {
                                    if (value === 0) {
                                        return "₩0원"; // 0일 때 처리
                                    } else if (value >= 100000000) {
                                        let result = (value / 100000000).toFixed(1);
                                        return "₩" + (result.endsWith(".0") ? parseInt(result) : result) + "억원"; // 억원 단위
                                    } else {
                                        return "₩" + (value / 10000000).toFixed(0) + "천만원"; // 천만원 단위
                                    }
                                },
                            },
                            title: {
                                display: true,
                            },
                        },
                        x: {
                            grid: {
                                display: false,
                                drawBorder: false,
                                color: "rgba(143, 146, 161, .1)",
                                zeroLineColor: "rgba(143, 146, 161, .1)",
                            },
                            ticks: {
                                padding: 20,
                            },
                        },
                    },
                },
            });
            //========== 막대 그래프 끝



            // 전체 선택/해제 스크립트
            function toggleAllCheckboxes(selectAll) {
                const checkboxes = document.querySelectorAll('input[name="selectedRequests"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = selectAll.checked;
                });
            }
        </script>
    </th:block>
</th:block>
</html>
